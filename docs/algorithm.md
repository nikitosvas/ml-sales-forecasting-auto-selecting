
# üìå –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–µ–∫—Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–¥–∞–∂

–î–∞–Ω–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π  
(–≤—ã—Ä—É—á–∫–∞, –ø—Ä–∏–±—ã–ª—å –∏ –¥—Ä.) –ø–æ –∫–∞–∂–¥–æ–º—É –∫–∞–Ω–∞–ª—É –ø—Ä–æ–¥–∞–∂ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞.

–í –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ:

- Baseline-–º–æ–¥–µ–ª–∏ (Weekly Naive + —Ç—Ä–µ–Ω–¥ OLS)
- ML-–º–æ–¥–µ–ª–∏ CatBoost (recursive forecasting)

---

# 1. –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –ø–∞–π–ø–ª–∞–π–Ω–∞

–ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —à–∞–≥–æ–≤:

1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ ClickHouse
2. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–±—â–µ–≥–æ long-—Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (exogenous features)
4. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–≤—É–º—è –º–æ–¥–µ–ª—è–º–∏:
   - Baseline
   - CatBoost
5. –†–∞—Å—á—ë—Ç –º–µ—Å—è—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫ –∫–∞—á–µ—Å—Ç–≤–∞
6. –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

---

# 2. –î–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏

## 2.1 –ò—Å—Ç–æ—á–Ω–∏–∫ —Ñ–∞–∫—Ç–∞

–§–∞–∫—Ç –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ ClickHouse –ø–æ —Å–ª–µ–¥—É—é—â–∏–º –∏–∑–º–µ—Ä–µ–Ω–∏—è–º:

- SALES_SUBSPECIES (–∫–∞–Ω–∞–ª –ø—Ä–æ–¥–∞–∂)
- SIGN_IRIS 
- –ú–µ—Ç—Ä–∏–∫–∏:
  - SUM_SNDS
  - SUM_PROFIT
  - SUM_PROFIT_NO_KSP
  - SUM_COST_SNDS
  - SUM_COST_NONDS

---

## 2.2 –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—â–µ–≥–æ long-DataFrame

–ü–æ—Å–ª–µ –≤—ã–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–≤–æ–¥—è—Ç—Å—è –≤ **–¥–ª–∏–Ω–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç**:

–û–¥–Ω–∞ —Å—Ç—Ä–æ–∫–∞ = –æ–¥–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ –≤ –æ–¥–∏–Ω –¥–µ–Ω—å:

| DDATE | FULL_SIGN                      | METRIC_NAME | METRIC_VALUE |
|------|--------------------------------|-------------|--------------|
| 2025-09-01 | –ö–ü –†–ï–ì–ò–û–ù –ê | SUM_SNDS | 1 200 000 |

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –ª–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å —Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
- –æ–¥–∏–Ω–∞–∫–æ–≤–æ –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª–∏ –¥–ª—è –ª—é–±—ã—Ö –∫–∞–Ω–∞–ª–æ–≤

---

# 3. –ö–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ (Calendar Features)

–ü–æ—Å–ª–µ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è long_df –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è exogenous –ø—Ä–∏–∑–Ω–∞–∫–∏:

- DAY_OF_WEEK ‚Äî –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (0‚Äì6)
- DAY_OF_MONTH ‚Äî –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
- MONTH ‚Äî –Ω–æ–º–µ—Ä –º–µ—Å—è—Ü–∞
- WEEK_OF_YEAR ‚Äî –Ω–æ–º–µ—Ä –Ω–µ–¥–µ–ª–∏
- IS_WEEKEND ‚Äî –≤—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å
- IS_HOLIDAY ‚Äî –ø—Ä–∞–∑–¥–Ω–∏–∫ (–∏–∑ —Å–ø–∏—Å–∫–∞ HOLIDAYS)
- START_OF_WEEK / END_OF_WEEK
- START_OF_MONTH / END_OF_MONTH
- MONTH_PROGRESS ‚Äî –ø—Ä–æ–≥—Ä–µ—Å—Å –º–µ—Å—è—Ü–∞

–≠—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –º–æ–¥–µ–ª—å—é CatBoost –∫–∞–∫ –≤—Ö–æ–¥–Ω—ã–µ —Ñ–∏—á–∏.

---

# 4. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –¥–ª—è –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∫–∏

–ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏:

- FULL_SIGN (–∫–∞–Ω–∞–ª + IRIS)
- METRIC_NAME (–≤—ã—Ä—É—á–∫–∞/–ø—Ä–∏–±—ã–ª—å)

–î–ª—è –∫–∞–∂–¥–æ–π —Å–≤—è–∑–∫–∏ —Å—Ç—Ä–æ—è—Ç—Å—è:

- baseline-–ø—Ä–æ–≥–Ω–æ–∑
- CatBoost-–ø—Ä–æ–≥–Ω–æ–∑
- –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

---

# 5. Baseline –º–æ–¥–µ–ª—å (Weekly Naive + OLS Trend)

## 5.1 –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

Baseline –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–∞–∫ –ø—Ä–æ—Å—Ç–æ–π –æ—Ä–∏–µ–Ω—Ç–∏—Ä:

- –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º –ø—Ä–æ–¥–∞–∂–∏ –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
- –¥–æ–±–∞–≤–ª—è–µ–º –æ–±—â–∏–π –ª–∏–Ω–µ–π–Ω—ã–π —Ç—Ä–µ–Ω–¥ —á–µ—Ä–µ–∑ OLS

---

## 5.2 –ê–ª–≥–æ—Ä–∏—Ç–º baseline_forecast

1. –ë–µ—Ä—ë–º —Ç–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏—é –î–û –¥–∞—Ç—ã —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞: df[df["DDATE"] < START_FORECAST_DATE]
2. –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –µ—ë –æ–±—É—á–∞—é—â–∏–º –æ–∫–Ω–æ–º: train_window_days = 60
3. –°—á–∏—Ç–∞–µ–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ –∫–∞–∂–¥–æ–º—É –¥–Ω—é –Ω–µ–¥–µ–ª–∏:  
    mean(METRIC_VALUE | Monday)
    mean(METRIC_VALUE | Tuesday)
4. –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç—Ä–µ–Ω–¥–∞ –ø–æ –Ω–µ–¥–µ–ª—å–Ω—ã–º —Å—É–º–º–∞–º: trend_coef = 1 + slope * horizon_weeks / mean_level
5. –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞: FORECAST = dow_mean[dow] * trend_coef
Baseline –Ω–µ –æ–±—É—á–∞–µ—Ç —Å–ª–æ–∂–Ω—É—é –º–æ–¥–µ–ª—å, —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–æ –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ.

---
# 6. ML –º–æ–¥–µ–ª—å CatBoost (Recursive Month Forecast)

## 6.1 –û—Å–Ω–æ–≤–Ω–∞—è –∏–¥–µ—è

CatBoost –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏ –ø–æ –¥–Ω—è–º —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

- –ª–∞–≥–æ–≤ –ø—Ä–æ–¥–∞–∂
- rolling-—Å—Ä–µ–¥–Ω–∏—Ö
- –∫–∞–ª–µ–Ω–¥–∞—Ä–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ü—Ä–æ–≥–Ω–æ–∑ —Å—Ç—Ä–æ–∏—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ:

‚úÖ –ø—Ä–æ–≥–Ω–æ–∑ –¥–Ω—è t –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –∫–∞–∫ —Ñ–∞–∫—Ç –¥–ª—è –¥–Ω—è t+1

---

## 6.2 –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ lag/rolling –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–î–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏–∑–Ω–∞–∫–∏:

- LAG_7D, LAG_14D, LAG_28D
- ROLL_MEAN_7, ROLL_MEAN_14, ROLL_MEAN_28

–ü—Ä–∏–º–µ—Ä:
- LAG_7D = –ø—Ä–æ–¥–∞–∂–∏ 7 –¥–Ω–µ–π –Ω–∞–∑–∞–¥
- ROLL_MEAN_14 = —Å—Ä–µ–¥–Ω–µ–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 14 –¥–Ω–µ–π
- PS: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–ª —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ª–∞–≥–∞ 1 –¥–µ–Ω—å, –Ω–æ –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –•–£–ñ–ï (–≤–µ—Ä–æ—è—Ç–Ω–æ –ø–æ—Ç–æ–º—É —á—Ç–æ –≤ –ø–Ω —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ –í–°–ö–† –∏ —Ç–¥)

## 6.3 –ê–ª–≥–æ—Ä–∏—Ç–º recursive forecasting

–î–ª—è –∫–∞–∂–¥–æ–π –¥–∞—Ç—ã –ø—Ä–æ–≥–Ω–æ–∑–∞:

1. –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º lag-features
2. –≤—ã–¥–µ–ª—è–µ–º train-window –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N –¥–Ω–µ–π
3. –æ–±—É—á–∞–µ–º CatBoostRegressor
4. –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ METRIC_VALUE –Ω–∞ 1 –¥–µ–Ω—å
5. –¥–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≥–Ω–æ–∑ –≤ work_df –∫–∞–∫ –Ω–æ–≤—ã–π —Ñ–∞–∫—Ç
6. –ø–µ—Ä–µ—Ö–æ–¥–∏–º –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –¥–Ω—é

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º —Å—Ç—Ä–æ–∏—Ç—Å—è –ø—Ä–æ–≥–Ω–æ–∑ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞.

---

# 7. –§–∞–∫—Ç –º–µ—Å—è—Ü–∞ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –æ—à–∏–±–æ–∫

–î–ª—è –æ—Ü–µ–Ω–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ –±–µ—Ä—ë—Ç—Å—è —Ñ–∞–∫—Ç –∑–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –º–µ—Å—è—Ü:
- fact_month_df = –¥–∞—Ç—ã –æ—Ç START_FORECAST_DATE –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞

–ú–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å:

- –≤—ã—Ö–æ–¥–Ω—ã–µ
- –ø—Ä–∞–∑–¥–Ω–∏–∫–∏

–ù–æ –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Ñ–∞–∫—Ç —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ü–µ–ª–∏–∫–æ–º, –±–µ–∑ —Ä—É—á–Ω–æ–≥–æ –∑–∞–Ω—É–ª–µ–Ω–∏—è.

---

# 8. –ú–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞

–ü–æ—Å–ª–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ —Å—á–∏—Ç–∞—é—Ç—Å—è –º–µ—Å—è—á–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

- MAE
- WMAPE
- BIAS

–ù–∞ —É—Ä–æ–≤–Ω–µ –º–µ—Å—è—Ü–∞:
- FACT_MONTH = —Å—É–º–º–∞ —Ñ–∞–∫—Ç–∞
- FORECAST_MONTH = —Å—É–º–º–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞
- MAPE_MONTH = |–æ—à–∏–±–∫–∞| / —Ñ–∞–∫—Ç
- BIAS_MONTH = –æ—à–∏–±–∫–∞ / —Ñ–∞–∫—Ç
–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å—Ä–∞–≤–Ω–∏—Ç—å:

‚úÖ baseline vs CatBoost

---

# 9. –ò—Ç–æ–≥ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –ø–æ–ª–Ω—ã–π production-–ø–∞–π–ø–ª–∞–π–Ω:

- –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- feature engineering
- baseline –ø—Ä–æ–≥–Ω–æ–∑
- ML –ø—Ä–æ–≥–Ω–æ–∑
- —Ä–µ–∫—É—Ä—Å–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –¥–æ –∫–æ–Ω—Ü–∞ –º–µ—Å—è—Ü–∞
- —Ä–∞—Å—á—ë—Ç –º–µ—Ç—Ä–∏–∫
- —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–µ–π
- –≤—ã–±–æ—Ä –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏ + –∫–æ–ª-–≤–æ –¥–Ω–µ–π –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–∞–ª–∞ + –º–µ—Ç—Ä–∏–∫–∏

---
****

